#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üîç Checking staged changes for HTML files..."

# R√©cup√©rer la liste des fichiers staged pour le push
MODIFIED_FILES=$(git diff --cached --name-only --diff-filter=ACM)

# Liste des fichiers HTML √† surveiller
TARGET_FILES="index.html updates.html legal.html forum.html form.html about.html"

TO_UPDATE=""

# V√©rifie si des fichiers staged correspondent aux fichiers HTML suivis
for file in $MODIFIED_FILES; do
  for target in $TARGET_FILES; do
    if [ "$file" = "$target" ]; then
      TO_UPDATE="$TO_UPDATE $file"
    fi
  done
done

# Si aucun fichier HTML n'a √©t√© modifi√©, on continue normalement
if [ -z "$TO_UPDATE" ]; then
  echo "‚úÖ No relevant HTML files changed. Proceeding to push."
else
  echo "üîÑ Updating timestamps for modified HTML files..."
  node scripts/add-timestamps.mjs $TO_UPDATE
  git add $TO_UPDATE
fi